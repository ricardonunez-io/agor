# PostgreSQL + RBAC Testing Environment
#
# Usage:
#   docker compose --env-file .env.postgres up
#   OR: Copy to .env and use: docker compose up
#
# This configuration enables:
# - PostgreSQL database (instead of SQLite)
# - RBAC + Unix integration (insulated mode)
# - Multi-user testing (alice, bob)
# - SSH server for testing
# - Development fixtures

# Enable postgres profile
COMPOSE_PROFILES=postgres

# PostgreSQL database configuration
AGOR_DB_DIALECT=postgresql
DATABASE_URL=postgresql://agor:agor_dev_secret@postgres:5432/agor

# RBAC Configuration
# Enable worktree RBAC and Unix group isolation
AGOR_RBAC_ENABLED=true
# Unix user mode: simple | insulated | opportunistic | strict
AGOR_UNIX_USER_MODE=opportunistic

# Create test users (alice, bob) on startup
CREATE_RBAC_TEST_USERS=true

# SSH port for multi-user testing (exposed as host port)
SSH_PORT=2222

# Seed development data (creates agor repo + test worktree)
SEED=true

# Port configuration (different from default to allow running alongside SQLite mode)
DAEMON_PORT=4091
UI_PORT=6091
